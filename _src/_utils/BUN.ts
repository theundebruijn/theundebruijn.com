///////////////
///// OBJ /////
///////////////

import { ENV } from "./ENV";

const BUN = Object.create(null);

///////////////////////
///// OBJ METHODS /////
///////////////////////

BUN.createWebSocketListener = function(fCB)
{
  if (ENV.state.build.environment !== "development") { fCB(); return; };

  const socket = new WebSocket("ws://" + ENV.state.build.debugUrl + ":" + ENV.state.build.debugPort);

  socket.addEventListener("open", function(event) {
    socket.send("pong");

    fCB();
  }.bind(this));

  socket.addEventListener("message", function(event) {
    if (event.data === "boom! new build ready.") window.location.reload();
  }.bind(this));
};

//////////////////////
///// ES6 EXPORT /////
//////////////////////

export { BUN };

////////////////////////////////////////////////////////////
//////////////////////////.        /////////////////////////
/////////////////////     .      ..  ...////////////////////
///////////////////    ..  .   ....    .  ./////////////////
//////////////////        . .  . ...  . ... ////////////////
/////////////////     ...................   ////////////////
/////////////////  .(,(/.%,.*%#&&&.//....   ////////////////
/////////////////  .***/..*,*/%,%%#%*/(/(. ,* //////////////
////////////////( ******  #%#((&%%*&///%%*..(.//////////////
/////////////////(/,((//**&.*,%%(*//.**##, .#(//////////////
///////////////( .(,**....* ...,*,,,%&,((*.* .//////////////
///////////////( . **..(*#/ %%%%#,*##,..*%,,.///////////////
////////////////(.,#/%#%%,#(%#(/&&(%,(.//#,..///////////////
//////////////////(,,/*#(.#/ /(&..%/&/(*(.//////////////////
///////////////////( ***#     .,.,/&%%%*.///////////////////
////////////////////(./,/*,,.,&*(((%%(/ ////////////////////
///////////////////////**.*.*//##.*,,,//////////////////////
///////////////////////  ,*%%/@//(*   ./////////////////////
//////////////////////                 /////////////////////
////////////////////                     ///////////////////